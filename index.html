<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cats & Guns Central</title>
  <style>
    /* ... existing styles ... */
    #loginContainer {
      display: none; /* Hide by default */
      position: absolute;
      top: 60px;
      right: 10px;
      background: rgba(255,255,255,0.9);
      padding: 10px;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      z-index: 30;
    }
  </style>
</head>
<body>
  <!-- Search Bar -->
  <div id="searchBarContainer">
    <input type="text" id="searchBar" placeholder="Search..." />
  </div>

  <!-- Login Form -->
  <div id="loginContainer">
    <input type="email" id="emailInput" placeholder="Email" />
    <input type="password" id="passwordInput" placeholder="Password" />
    <button id="signInBtn">Sign In</button>
  </div>

  <header>
    <h1>Cats & Guns Central</h1>
    <nav>
      <ul>
        <li><a href="Snake.html" id="homeLink">Home</a></li>
        <li><a href="#" id="gunsLink">Guns</a></li>
        <li><a href="#" id="catsLink">Cats</a></li>
        <li><a href="#" id="chatLink">Chat</a><span id="unreadBadge"></span></li>
        <li><a href="#">Contact</a></li>
        <!-- NEW: Login button -->
        <li><a href="#" id="loginBtn">Login</a></li>
      </ul>
    </nav>
  </header>

  <!-- Hero, main, footer, chat modal, etc. remain the same -->
  <!-- ... -->

  <script type="module">
    import {
      initializeApp
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import {
      getAuth,
      signInWithEmailAndPassword
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
    import {
      getDatabase,
      ref,
      push,
      onChildAdded,
      remove
    } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

    const firebaseConfig = {
      /* ... your config ... */
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    let currentUsername = "Anonymous";
    const loginContainer = document.getElementById("loginContainer");
    const emailInput = document.getElementById("emailInput");
    const passwordInput = document.getElementById("passwordInput");
    const signInBtn = document.getElementById("signInBtn");
    const loginBtn = document.getElementById("loginBtn");

    // Check if user is still validly "logged in" (within 8 hours)
    function isLoggedIn() {
      const loginTime = localStorage.getItem("loginTime");
      if (!loginTime) return false;
      const eightHours = 8 * 60 * 60 * 1000;
      return (Date.now() - loginTime) < eightHours;
    }

    // On page load, either show or hide the login form
    window.addEventListener("load", () => {
      if (isLoggedIn()) {
        loginContainer.style.display = "none";
      } else {
        loginContainer.style.display = "block";
      }
    });

    // Show login form when clicking "Login" if not already logged in
    loginBtn.addEventListener("click", (e) => {
      e.preventDefault();
      if (!isLoggedIn()) {
        loginContainer.style.display = "block";
      } else {
        alert("Youâ€™re already logged in!");
      }
    });

    // Sign in and store timestamp
    signInBtn.addEventListener("click", () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();
      signInWithEmailAndPassword(auth, email, password)
        .then(() => {
          currentUsername = email.split("@")[0];
          alert("Signed in as " + currentUsername + "!");
          localStorage.setItem("loginTime", Date.now());
          loginContainer.style.display = "none";
        })
        .catch((error) => {
          alert("Sign-in failed: " + error.message);
        });
    });

    // ... rest of your chat logic, etc. ...
  </script>
</body>
</html>
